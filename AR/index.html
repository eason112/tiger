<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link rel="stylesheet" href="style.css">
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  
  <style>
	model-viewer {
		position:absolute;
		border: 0;
		border-radius: 0%;
		height:50%;
		width:100%;
		margin: 0 auto;
    top: 50%;
    left: 50%;
    transform: translate(-50%,-50%);
	}
		
	
	</style>
  </head>

  <body>

	  <model-viewer id="gameboy" src="Model_Gameboy.glb"
			ios-src="../Model_Gameboy.usdz"
			alt="A 3D model of an astronaut"
			ar
			auto-rotate
	    	camera-controls></model-viewer>
      <button id="backButton">返回</button>
  </body>


  <script>
    // 获取返回按钮
    const modelViewer = document.querySelector('model-viewer');
    let arButton;
    
    
    function isMobileDeviceAR() {
      const userAgent = navigator.userAgent.toLowerCase();
      return /iphone|ipod|android|windows phone|blackberry|iemobile/.test(userAgent);
    }

    function triggerAR() {
      
      if (arButton) {

          //arButton.click();  // 模擬點擊 AR 按鈕
      }
    }

    if(isMobileDeviceAR()){
      if (modelViewer) {
        modelViewer.addEventListener('load', function() {
            console.log('Model-viewer has fully loaded.');
            // 等待 shadowRoot 生成，並觸發 AR 按鈕
            //modelViewer.activateAR();
            arButton = modelViewer.shadowRoot.querySelector('#default-ar-button');
            setTimeout(() => {
              //triggerAR();
            },1000);
            
        });
    }
    }
    const backButton = document.getElementById("backButton");

    // 为返回按钮添加点击事件
    backButton.addEventListener("click", function() {
      // 尝试关闭当前页面
      modelViewer.activateAR();
      //window.close();
    });
  </script>
</html>